/*--------------------------------*- C++ -*----------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  v2212                                 |
|   \\  /    A nd           | Website:  www.openfoam.com                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    object      snappyHexMeshDict;
}
castellatedMesh true;

snap            true;

addLayers       true;

geometry
{
    geom_AVA_fine_m.obj
    {
        type            triSurfaceMesh;
        regions
        {
            stilts
            {
                name            stilts;
            }
            body_rest
            {
                name            body_rest;
            }
            body_LH_fine
            {
                name            body_LH_fine;
            }
            body_LH
            {
                name            body_LH;
            }
            windshield
            {
                name            windshield;
            }
            window_LH
            {
                name            window_LH;
            }
            lh_mirror
            {
                name            lh_mirror;
            }
            APillarFine_LH
            {
                name            APillarFine_LH;
            }
            APillar_LH
            {
                name            APillar_LH;
            }
            rh_mirror
            {
                name            rh_mirror;
            }
            APillar_RH
            {
                name            APillar_RH;
            }
            APillarFine_RH
            {
                name            APillarFine_RH;
            }
            window_RH
            {
                name            window_RH;
            }
            body_RH
            {
                name            body_RH;
            }
            body_RH_fine
            {
                name            body_RH_fine;
            }
        }
    }
    box1
    {
        type            searchableBox;
        min             ( -1.73525 -2.32717 -0.1 );
        max             ( 3.02611 2.32717 1.86 );
    }
    box2
    {
        type            searchableBox;
        min             ( -9.13054 -3.87861 -0.1 );
        max             ( 9.10443 3.87861 2.7 );
    }
    box3
    {
        type            searchableBox;
        min             ( -9.13054 -6.9815 -0.66 );
        max             ( 21.2611 6.9815 7.46 );
    }
    vr_window_LH
    {
        type            subTriSurfaceMesh;
        surface         geom_AVA_fine_m.obj;
        patches         ( window_LH );
    }
    vr_body_LH_fine
    {
        type            subTriSurfaceMesh;
        surface         geom_AVA_fine_m.obj;
        patches         ( body_LH_fine );
    }
    mirror_refinement.obj
    {
        type            triSurfaceMesh;
        name            vr_lh_mirror;
    }
    vr_APillar_LH
    {
        type            subTriSurfaceMesh;
        surface         geom_AVA_fine_m.obj;
        patches         ( "APillar.*LH" );
    }
}

castellatedMeshControls
{
    maxLocalCells   200000000;
    maxGlobalCells  300000000;
    minRefinementCells 20;
    nCellsBetweenLevels 5;
    maxLoadUnbalance 0.1;
    allowFreeStandingZoneFaces true;
    resolveFeatureAngle 30;
    features        ( { file "geom_AVA_fine_m.eMesh" ; level 0 ; } );
    refinementSurfaces
    {
        geom_AVA_fine_m.obj
        {
            level           ( 0 0 );
            regions
            {
                body_rest
                {
                    level           ( 7 7 );
                }
                body_LH
                {
                    level           ( 7 7 );
                }
                stilts
                {
                    level           ( 7 7 );
                }
                body_RH_fine
                {
                    level           ( 7 7 );
                }
                APillarFine_RH
                {
                    level           ( 7 7 );
                }
                body_RH
                {
                    level           ( 7 7 );
                }
                window_RH
                {
                    level           ( 7 7 );
                }
                APillarFine_LH
                {
                    level           ( 9 9 );
                }
                APillar_RH
                {
                    level           ( 7 7 );
                }
                windshield
                {
                    level           ( 7 7 );
                }
                rh_mirror
                {
                    level           ( 7 7 );
                }
                window_LH
                {
                    level           ( 8 8 );
                }
                body_LH_fine
                {
                    level           ( 8 8 );
                }
                lh_mirror
                {
                    level           ( 9 9 );
                }
                APillar_LH
                {
                    level           ( 9 9 );
                }
            }
        }
    }
    refinementRegions
    {
        box1
        {
            mode            inside;
            levels          1 ( ( 1e+15 5 ) );
        }
        box2
        {
            mode            inside;
            levels          1 ( ( 1e+15 4 ) );
        }
        box3
        {
            mode            inside;
            levels          1 ( ( 1e+15 1 ) );
        }
        vr_window_LH
        {
            mode            distance;
            levels          ( ( 0.05 8 ) ( 0.15 7 ) );
        }
        vr_body_LH_fine
        {
            mode            distance;
            levels          ( ( 0.05 8 ) ( 0.15 7 ) );
        }
        vr_lh_mirror
        {
            mode            inside;
            levels          ( ( 0 8 ) );
        }
        vr_APillar_LH
        {
            mode            distance;
            levels          ( ( 0.05 8 ) (0.15 7));
        }
    }
    locationInMesh  ( -9.15665 -6.53295 1.91 );
}

snapControls
{
    tolerance       2;
    implicitFeatureSnap false;
    explicitFeatureSnap true;
    multiRegionFeatureSnap true;
    detectNearSurfacesSnap true;
    nSmoothPatch    3;
    nSolveIter      100;
    nRelaxIter      5;
    nFeatureSnapIter 10;
    nFaceSplitInterval 5;
}

addLayersControls
{
    layerTerminationAngle -180;
    detectExtrusionIsland true;
    layers
    {
        body_rest
        {
            nSurfaceLayers  16;
            firstLayerThickness 8.99e-06;
            expansionRatio  1.4;
        }
        body_LH
        {
            nSurfaceLayers  16;
            firstLayerThickness 7.61e-06;
            expansionRatio  1.4;
        }
        stilts
        {
            nSurfaceLayers  16;
            firstLayerThickness 1.17e-05;
            expansionRatio  1.4;
        }
        APillarFine_LH
        {
            nSurfaceLayers  16;
            firstLayerThickness 2.93e-06;
            expansionRatio  1.4;
        }
        windshield
        {
            nSurfaceLayers  16;
            firstLayerThickness 9.18e-06;
            expansionRatio  1.4;
        }
        window_LH
        {
            nSurfaceLayers  16;
            firstLayerThickness 1.17e-05;
            expansionRatio  1.34;
        }
        body_LH_fine
        {
            nSurfaceLayers  16;
            firstLayerThickness 1.12e-05;
            expansionRatio  1.34;
        }
        lh_mirror
        {
            nSurfaceLayers  16;
            firstLayerThickness 5.86e-06;
            expansionRatio  1.34;
        }
        APillar_LH
        {
            nSurfaceLayers  16;
            firstLayerThickness 5.84e-06;
            expansionRatio  1.34;
        }
        ZMin
        {
            nSurfaceLayers  16;
            firstLayerThickness 7.49e-05;
            expansionRatio  1.4;
        }
    }
    relativeSizes   false;
    firstLayerThickness 0.003;
    expansionRatio  1.3;
    minThickness    1e-08;
    nGrow           0;
    featureAngle    180;
    slipFeatureAngle 30;
    nMedialAxisIter 10;
    nRelaxIter      5;
    nSmoothSurfaceNormals 10;
    nSmoothNormals  10;
    nSmoothDisplacement 90;
    nSmoothThickness 10;
    maxFaceThicknessRatio 0.5;
    maxThicknessToMedialRatio 0.3;
    minMedialAxisAngle 130;
    nBufferCellsNoExtrude 0;
    nLayerIter      50;
    nRelaxedIter    0;
}

meshQualityControls
{
    maxNonOrtho     65;
    maxBoundarySkewness 20;
    maxInternalSkewness 4;
    maxConcave      80;
    minFlatness     0.5;
    minVol          1e-30;
    minTetQuality   1e-30;
    minArea         1e-30;
    minTwist        0.02;
    minDeterminant  0.001;
    minFaceWeight   0.05;
    minVolRatio     0.01;
    minTriangleTwist 0.001;
    nSmoothScale    4;
    errorReduction  0.75;
    relaxed
    {
        maxNonOrtho     75;
        maxInternalSkewness 8;
        minTetQuality   -1e+30;
        minTwist        1e-06;
        minDeterminant  1e-06;
        minFaceWeight   1e-06;
    }
}

debug           0;

mergeTolerance  1e-08;
