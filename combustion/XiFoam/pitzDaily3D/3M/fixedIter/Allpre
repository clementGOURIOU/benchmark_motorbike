#!/bin/bash
cd "${0%/*}" || exit                                # Run from this directory
. ${WM_PROJECT_DIR:?}/bin/tools/RunFunctions        # Tutorial run functions
#------------------------------------------------------------------------------

export caseName=`basename $PWD`

echo "Creating blockMeshDict with a m4 script"
m4 -P system/blockMeshDict.m4 > system/blockMeshDict

runApplication blockMesh

if [ -d 0 ]; then
    echo "$caseName: Time directory 0 exists and will be used for a restart."
else
    echo "$caseName: No time directory 0 found."
    echo "  Creating it from 0_orig with non-initilized fields."
    echo "  Consider using restart files if the run fails."
    cp -r 0_orig 0
fi

runApplication decomposePar

# Create a .foam file for paraview
folderName=${PWD##*/}
touch $folderName.foam

#------------------------------------------------------------------------------
